\section{REST-Webservice Spezifikation}

\subsection{Zugriffsstruktur}

\begin{tabularx}{\textwidth}{@{} | X | X | X | X | @{}}
	\hline
	\textbf{Methode} & \textbf{URL} & \textbf{Beschreibung} & \textbf{Kommunikationsdaten (Note to self: finde schöneres Wort!)} \\ \hline  \hline
	& & & \\ \hline
	POST & /students & Erstellt einen Studenten & tbd
	\\ \hline
	GET & /students/\{student\_id\} & Lese Informationen über Student & tbd
	\\ \hline
	PUT & /students/\{student\_id\} & Bearbeite Informationen über Student & tbd
	\\ \hline
	DELETE & /students/\{student\_id\} & Löscht Nutzer & tbd \\ \hline
	& & & \\ \hline
	POST & /plans & Erstellt neuen Studienplan & tbd \\ \hline
	GET & /plans/\{plan\_id\} & Lese Plan & tbd \\ \hline
	PUT & /plans/\{plan\_id\} & Bearbeite Plan & tbd \\ \hline
	DELETE & /plans/\{plan\_id\} & Lösche Plan & tbd \\ \hline
	PATCH & /plans/\{plan\_id\} & Erhalte Link zum teilen des Plans & tbd \\ \hline
	& & & \\ \hline
	GET & /plans/\{plan\_id\}/verification & Verifiziere den Plan und gebe das Ergebnis zurück & tbd \\ \hline
	POST & /plans/\{plan\_id\}/verification & Verifiziere den Plan und speichere das Ergebnis als Eigenschaft des Plans & tbd \\ \hline
	& & & \\ \hline
	PUT & /plans/\{plan\_id\}/proposal & Erstelle und Erhalte einen auf Basis des Plans generierten (neuen) Plan & tbd \\ \hline
	& & & \\ \hline
	GET & /plans/\{plan\_id\}/pdf & Retrieve pdf version of plan & tbd \\ \hline
	\hline
\end{tabularx}

\subsection{Authentifizierung}
\label{subsec:api-auth}
\paragraph{Zugrundeliegende Spezifikation} Die Authentifizierung erfolgt über die Implementierung einer OAuth 2.0 Schnittstelle nach RFC 6749 (Zitieren!).
Für das momentane System ist hierbei nur der \textit{Implicit-Grant-Typ} notwendig, jedoch sollte das System mindestens um den \textit{Authorization-Code-Grant-Typ} erweitert werden können.
\paragraph{Registrierung der Klienten}
Wir unterscheiden zwischen zwei Typen von Klienten: vertrauenswürdigen sowie öffentlichen Klienten. Die Definitionen hierzu finden sich auch in RFC 6749. Bei der Webapp unseres Systems handelt es sich auf Grund der Zugänglichkeit des Codes sowie der Daten um einen öffentlichen Klienten.
\subparagraph{Vertrauenswürdiger Klient}
Für einen vertrauenswürdigen Klienten werden folgende Informationen gespeichert:\\
\begin{tabularx}{\textwidth}{@{} | X | X | @{}}
	\hline
	\textbf{Name} & \textbf{Beschreibung}\\ \hline \hline
	api\_key & Eindeutige öffentliche ID des Klienten. Beginnt mit dem Präfix \enquote{key-} \\ \hline
	api\_secret & Nur dem Klienten bekannte Kennung. Beginnt mit dem Präfix \enquote{secret-} \\ \hline
	scope & Berechtigungen des Klienten. Vorerst immer \enquote{student} \\ \hline
	redirect\_url & URL an welche beim \textit{Implicit-Grant} bzw. \textit{Authorization-Code-Grant} weitergeleitet wird. \\ \hline
	origin & Domains, von welchen aus der Klient auf die Ressourcen zugreifen darf. Wird als Regulärer Ausdruck angegeben. \\
	\hline
\end{tabularx}

\subparagraph{Öffentlicher Klient}
Für einen öffentlichen Klienten werden folgende Informationen gespeichert:\\
\begin{tabularx}{\textwidth}{@{} | X | X | @{}}
	\hline
	\textbf{Name} & \textbf{Beschreibung}\\ \hline \hline
	api\_key & Eindeutige öffentliche ID des Klienten. Beginnt mit dem Präfix \enquote{key-} \\ \hline
	api\_secret & NULL (wird nicht benötigt) \\ \hline
	scope & Berechtigungen des Klienten. Vorerst immer \enquote{student} \\ \hline
	redirect\_url & URL an welche beim \textit{Implicit-Grant} bzw. \textit{Authorization-Code-Grant} weitergeleitet wird. \\ \hline
	origin & Domains, von welchen aus der Klient auf die Ressourcen zugreifen darf. Wird als Regulärer Ausdruck angegeben. \\
	\hline
\end{tabularx}
\paragraph{Schnittstellen}
Für die Authentifizierung werden folgende Schnittstellen verwendet:
\begin{table}
\begin{tabularx}{\textwidth}{@{} | X | X | X | X | @{}}
	\hline
	\textbf{Methode} & \textbf{URL} & \textbf{Beschreibung} & \textbf{Kommunikation} \\ \hline \hline
	GET & /auth/login & Der in RFC 6749, Kapitel 3.1 definierte \textit{Authorization Endpoint} & --- \\ \hline
	POST & /auth/token & Der in RFC 6749, Kapitel 3.2 definierte \textit{Token Endpoint} & --- \\ \hline
\end{tabularx}
\end{table}
Beim Login wird hierbei der Webbrowser des Benutzers an auf die Seite /auth/login weitergeleitet, auf welcher er sich authentifiziert. Anschließend wird er auf die Hauptseite der Webapp weitergeleitet.
\paragraph{Datenaustausch}
Der Datenaustausch beim Aufruf der Schnittstellen ist wie folgt spezifiziert:\\
\begin{tabularx}{\textwidth}{@{} | X | X | X | @{}}
	\hline
	\textbf{Posten} & \textbf{Implicit-Grant} & \textbf{Authorization-Code-Grant} \\ \hline
	Anfrage-Header &
	\begin{itemize}
		\item[]
		\item[client\_id] \{api\_key\}
	\end{itemize} & \\
\end{tabularx}
\subsection{Spezifikation der Statuscodes}

\subsection{Spezifikation der JSON-Datenobjekte}
