% getparamdef environment
% #1: URI of the GET method
% #2: title used for refering (also used as label)
\newenvironment{getparamdef}[2]{
	\begin{longtable}{|p{.23\linewidth}|p{.65\linewidth}|}
		\multicolumn{2}{@{}l}{\label{GETP-#2}\textsf{\textbf{GET #1 \; (#2)}}} \vspace{2pt} \\
		\hhline{|=|=|}
		\textbf{Parametername} & \textbf{Wert} \\
		\hline 
		\endfirsthead
		
		\hline
		\textbf{Parametername} & \textbf{Wert} \\
		\endhead
		
		\hhline{|=|=|}
		\endlastfoot 
}{
	\end{longtable} \vspace{-12pt}
}

% getparamdef* environment
% #1: URI of the GET method
% #2: title used for refering (also used as label)
% #3: Additional description text
\newenvironment{getparamdef*}[3]{
	\begin{longtable}{|p{.23\linewidth}|p{.65\linewidth}|}
		\multicolumn{2}{@{}l}{\label{GETP-#2}\textsf{\textbf{GET #1 \; (#2)}}} \vspace{2pt} \\
		\multicolumn{2}{@{}p{.95\linewidth}}{#3} \vspace{2pt} \\
		\hhline{|=|=|}
		\textbf{Parametername} & \textbf{Wert} \\
		\hline 
		\endfirsthead
		
		\hline
		\textbf{Parametername} & \textbf{Wert} \\
		\endhead
		
		\hhline{|=|=|}
		\endlastfoot 
}{
	\end{longtable} \vspace{-12pt}
}

% refgetparams command
% #1: title used for refering
\newcommand{\refgetparams}[1]{\textit{\hyperref[GETP-#1]{#1*}}}

% optpar command
% #1: GET parameter name of the optional parameter
\newcommand{\optpar}[1]{\textit{#1}}

% refstatus command
% #1: status code number
\newcommand{\refstatus}[1]{
	%\hyperref[STATUS-#1]{
		#1
	%}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\FloatBarrier
\subsection{Zugriffsstruktur}
\label{subsec:rest_commands}

Im Folgenden wird die Zugriffsstruktur der REST-Schnittstelle anhand HTTP-Methoden und URIs beschrieben. GET-Parameter-Definitionen (*) sind weiter unten separat aufgeführt.
\begin{longtable}{| >{\hspace{0pt}} p{.11\textwidth} | >{\hspace{0pt}} p{.24\textwidth} | >{\hspace{0pt}} p{.21\textwidth} | >{\hspace{0pt}} p{.34\textwidth} |}
	\hline
	\textbf{Methode} & \textbf{URI} & \textbf{Beschreibung} & \textbf{Anfrage-Parameter\+/Rückgabewerte \+(Statuscodes)} \\ 
	\hhline{|=|=|=|=|}  
	\endfirsthead
	
	\hline
	\textbf{Methode} & \textbf{URI} & \textbf{Beschreibung} & \textbf{Anfrage-Parameter\+/Rückgabewerte \+(Statuscodes)} \\ 
	\hline  
	\endhead
	
	\hhline{|=|=|=|=|}   
	\endlastfoot
	%===============================================================================================
	GET & /modules &  Lese planunabhängige Modul-Liste (gefiltert) (Name, ECTS und Dozent) & Anfrage: \refgetparams{Modules-Parameter} \newline Rückgabe:  \jsonobj{ModulesResult} \\
	\hline
	GET & /modules/\jsonatom{Modul-ID} & Lese Modul (planunabhängig) & Anfrage: --- \newline Rückgabe: \jsonobj{ModuleResult} \\* 
	\hhline{|=|=|=|=|} 
	GET & /student & Lese Informationen über Student & Anfrage: --- \newline Rückgabe: \jsonobj{StudentResult} \\ 
	\hline
	PUT & /student & Ersetze Informationen über Student, lösche Verifikationsinformationen & Anfrage: \jsonobj{StudentPutRequest} \newline Rückgabe: \jsonobj{StudentResult} \\ 
	\hline
	DELETE & /student & Löscht Student & Anfrage: \jsonobj{StudentDeleteRequest} \newline Rückgabe: --- \\* 
	\hhline{|=|=|=|=|} 
	GET & /plans & Lese Planliste & Anfrage: --- \newline Rückgabe: \jsonobj{PlansGetResult} \\ 
	\hline
	POST & /plans & Erstellt neuen Studienplan & Anfrage: \jsonobj{PlansPostRequest} \newline Rückgabe: \jsonobj{PlansPostResult} \\* 
	\hhline{|=|=|=|=|} 
	GET & /plans/\jsonatom{Plan-ID} & Lese Plan & Anfrage: --- \newline Rückgabe: \jsonobj{PlanResult} \\ 
	\hline
	PUT & /plans/\jsonatom{Plan-ID} & Ersetze Plan & Anfrage: \jsonobj{PlanPutRequest} \newline Rückgabe: \jsonobj{PlanResult}\\ 
	\hline
	PATCH & /plans/\jsonatom{Plan-ID} & Bearbeite Plan: Name ändern & Anfrage: \jsonobj{PlanPatchPostRequest} \newline Rückgabe: \jsonobj{PlanPatchPostResult} \\ 
	\hline
	DELETE & /plans/\jsonatom{Plan-ID} & Lösche Plan & --- \\ 
	\hline
	POST & /plans/\jsonatom{Plan-ID} & Dupliziere Plan & Anfrage: \jsonobj{PlanPatchPostRequest} \newline Rückgabe: \jsonobj{PlanPatchPostResult} \\* 
	\hhline{|=|=|=|=|} 
	GET & /plans/\+\jsonatom{Plan-ID}/\+modules & Lese Modul-Liste (gefiltert) (Name, ECTS, Dozent und Präferenz) & Anfrage: \newline \refgetparams{PlanModules-Parameter} \newline Rückgabe: \jsonobj{PlanModulesResult} \\* 
	\hhline{|=|=|=|=|} 
	GET & /plans/\+\jsonatom{Plan-ID}/\+modules/\+\jsonatom{Modul-ID} & Lese Modul mit \jsonatom{Modul-ID} & Anfrage: --- \newline Rückgabe: \jsonobj{PlanModuleResult} \\ 
	\hline
	PUT & /plans/\+\jsonatom{Plan-ID}/\+modules/\+\jsonatom{Modul-ID} & Setze Modul in Plan in gegebenes Semester, setzte Verifizierung zurück & Anfrage: \jsonobj{PlanModulePutRequest} \newline Rückgabe: \jsonobj{PlanModulePutResult} \\ 
	\hline
	DELETE & /plans/\+\jsonatom{Plan-ID}/\+modules/\+\jsonatom{Modul-ID} & Lösche Modul aus Plan, setzte Verifizierung zurück & Anfrage: --- \newline Rückgabe: --- \\ 
	\hline
	PUT & /plans/\+\jsonatom{Plan-ID}/\+modules/\+\jsonatom{Modul-ID}/\+preference & Setze Bewertung für Modul & Anfrage: \jsonobj{ModulePreferencePutRequest} \newline Rückgabe: \jsonobj{ModulePreferencePutResult} \\* 
	\hhline{|=|=|=|=|} 
	GET & /plans/\+\jsonatom{Plan-ID}/\+verification & Verifiziere den Plan, gebe das Ergebnis zurück und speichere es in der Datenbank  &  Anfrage: --- \newline Rückgabe: \jsonobj{PlanVerificationResult} \\* 
	\hhline{|=|=|=|=|} 
	GET & /plans/\+\jsonatom{Plan-ID}/\+proposal/\+\jsonatom{Zielfunktion-ID} & Erstelle und Erhalte einen auf Basis des Plans generierten (neuen) Plan & Anfrage: \refgetparams{Proposal-Parameter} \newline Rückgabe: \jsonobj{PlanProposalResult} \\* 
	\hhline{|=|=|=|=|} 
	GET & /plans/\+\jsonatom{Plan-ID}/\+pdf & Lese PDF-Version des Plans & Anfrage: \refgetparams{PDF-Parameter} \newline Rückgabe: (Weiterleitung auf PDF) \\*  
	\hhline{|=|=|=|=|} 
	GET  & /filters & Lade Filtertypen und Beschränkungen & Anfrage: --- \newline Rückgabe: \jsonobj{FiltersResult} \\* 
	\hhline{|=|=|=|=|} 
	GET & /objective-functions & Lese Liste mit allen vorhandenen Zielfunktionen & Anfrage: --- \newline Rückgabe: \jsonobj{ObjectiveFunctionsResult} \\* 
	\hhline{|=|=|=|=|} 
	GET & /disciplines & Lese Liste mit allen angebotenen Studienfächern & Anfrage: --- \newline Rückgabe: \jsonobj{DisciplinesResult} \\*
	\hhline{|=|=|=|=|}
	GET & /subjects & Lese Liste mit allen angebotenen Vertiefungsfächern & Anfrage: --- \newline Rückgabe: \jsonobj{SubjectsResult} 
\end{longtable}

\subsubsection*{GET-Anfrageparameter}

Die Parameter der GET-Anfragen werden im Folgenden tabellarisch beschrieben. Parameter mit \optpar{kursivem Namen} sind optional und werden nur falls nötig angegeben.
\vspace{-1pt} % To prevent the bottom line of the following table to be broken across pages. #LatexIsCrap

\begin{getparamdef*}{/modules}{Modules-Parameter}
	{$\textit{filter}_k \in \{\texttt{ects}, \texttt{category}, \texttt{type}, \texttt{discipline}, \texttt{compulsory}, \texttt{cycletype}, \texttt{name}\}$, bildet die Liste der aktivierten Filter; \newline
	Sofern \textit{filters} leer oder nicht vorhanden ist, werden die Module ohne Filterung zurückgegeben.}
	\optpar{filters} & $\textit{filter}_1,...,\textit{filter}_n$ \\
	\hline
	\optpar{ects-min} & \jsonatom{Untere-ECTS-Schranke} \\
	\hline
	\optpar{ects-max} & \jsonatom{Obere-ECTS-Schranke} \\
	\hline
	\optpar{category} & \multirow{5}{*}{(\jsonatom{Item-ID} des ausgewählten Elements)} \\*
	\cline{1-1}
	\optpar{type} & \\
	\cline{1-1}
	\optpar{discipline} & \\
	\cline{1-1}
	\optpar{compulsory} & \\
	\cline{1-1}
	\optpar{cycletype} & \\*
	\hline
	\optpar{name} & (Suchstring)
\end{getparamdef*}

\begin{getparamdef}{/plans/\jsonatom{Plan-ID}/modules}{PlanModules-Parameter}
	\multicolumn{2}{|c|}{(siehe \refgetparams{Modules-Parameter})}
\end{getparamdef}

\begin{getparamdef}{/plans/\jsonatom{Plan-ID}/proposal/\jsonatom{Zielfunktion-ID}}{Proposal-Parameter}
	\optpar{min-semesters} & \jsonatom{Semester-Minimum}\\
	\hline
	\optpar{max-semesters} & \jsonatom{Semester-Maximum}\\
	\hline
	\optpar{min-semester-ects} & \jsonatom{Semester-ECTS-Minimum} \\
	\hline
	\optpar{max-semester-ects} & \jsonatom{Semester-ECTS-Maximum} \\
	\hline
	\optpar{preferred-subject} & (Nummer des ausgewählten Vertiefungsfaches) \\
\end{getparamdef}

\begin{getparamdef}{/plans/\jsonatom{Plan-ID}/pdf}{PDF-Parameter}
	access-token & \jsonatom{Access-Token}
\end{getparamdef}

